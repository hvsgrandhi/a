## üí° What is CORBA?

**CORBA (Common Object Request Broker Architecture)** is a **middleware standard** defined by **OMG (Object Management Group)** that allows communication between **objects written in different programming languages** and running on different machines.

* It enables distributed computing by acting as a **broker** between client and server objects.
* Java supports CORBA through **Java IDL (Interface Definition Language)**.
* ORB (Object Request Broker) is the core of CORBA, which allows clients to invoke methods on a remote object as if it's local.

---

## üìÅ Folder Structure

```plaintext
corba-calculator/
‚îÇ
‚îú‚îÄ‚îÄ Calculator.idl           # Interface Definition
‚îú‚îÄ‚îÄ CalculatorImpl.java      # Implementation of the interface (Server Side)
‚îú‚îÄ‚îÄ CalculatorServer.java    # Server setup code
‚îú‚îÄ‚îÄ CalculatorClient.java    # Client code to invoke methods
```

---

## üß© Files Explained

### `Calculator.idl`

Defines the **remote interface** that both client and server understand.

```idl
module CalculatorApp {
  interface Calculator {
    float add(in float a, in float b);
    float subtract(in float a, in float b);
    float multiply(in float a, in float b);
    float divide(in float a, in float b);
  };
};
```

* `module CalculatorApp` creates a namespace.
* `interface Calculator` defines remote methods with parameters marked as `in`.

---

### `CalculatorImpl.java`

This class implements the remote interface.

```java
public class CalculatorImpl extends CalculatorPOA {
    public float add(float a, float b) { return a + b; }
    public float subtract(float a, float b) { return a - b; }
    public float multiply(float a, float b) { return a * b; }
    public float divide(float a, float b) { return b == 0 ? 0 : a / b; }
}
```

* Inherits from `CalculatorPOA` (generated by `idlj` compiler).
* Implements actual logic of the methods.

---

### `CalculatorServer.java`

Sets up the server to host the Calculator object.

```java
public class CalculatorServer {
    public static void main(String[] args) {
        ...
        ORB orb = ORB.init(args, null);
        POA rootpoa = POAHelper.narrow(orb.resolve_initial_references("RootPOA"));
        rootpoa.the_POAManager().activate();

        CalculatorImpl calcImpl = new CalculatorImpl();
        org.omg.CORBA.Object ref = rootpoa.servant_to_reference(calcImpl);
        Calculator href = CalculatorHelper.narrow(ref);

        NamingContextExt ncRef = NamingContextExtHelper.narrow(
            orb.resolve_initial_references("NameService")
        );

        NameComponent path[] = ncRef.to_name("Calculator");
        ncRef.rebind(path, href);

        System.out.println("Calculator Server ready and waiting...");
        orb.run();
        ...
    }
}
```

* Registers the implementation with the **naming service**.

---

### `CalculatorClient.java`

Client that looks up the server and calls methods.

```java
public class CalculatorClient {
    public static void main(String[] args) {
        ...
        ORB orb = ORB.init(args, null);
        NamingContextExt ncRef = NamingContextExtHelper.narrow(
            orb.resolve_initial_references("NameService")
        );
        Calculator calcRef = CalculatorHelper.narrow(ncRef.resolve_str("Calculator"));
        
        // Remote method calls
        System.out.println("Addition: " + calcRef.add(10, 5));
        ...
    }
}
```

---

## üõ†Ô∏è Practical Setup (Step-by-Step)

### üß± Step 1: Install Java

```bash
sudo apt update
sudo apt install openjdk-8-jdk -y
java -version
```

Make sure version is 1.8 (CORBA removed in Java 11+).

### ‚úÖ Step 2: Configure Java (if multiple versions)

```bash
sudo update-alternatives --config java
```

```bash
sudo update-alternatives --config javac
```

Choose Java and javac 8.

---

### üìå Step 3: Create and Compile IDL File

```bash
idlj -fall Calculator.idl
```

This generates a `CalculatorApp/` folder containing:

* `Calculator.java` (interface)
* `CalculatorHelper.java`, `CalculatorHolder.java`
* `CalculatorOperations.java`
* `CalculatorPOA.java` (Server-side base class)

---

### üßæ Step 4: Compile Java Code

```bash
javac *.java CalculatorApp/*.java
```

This compiles:

* Your implementation classes
* The generated IDL stubs/skeletons

---

### üåê Step 5: Start ORB Daemon

Start the **CORBA Naming Service (ORBD)**:

```bash
orbd -ORBInitialPort 1050
```

> Keep this terminal open. It allows naming service binding/lookup.

---

### üñ•Ô∏è Step 6: Run Server

```bash
java CalculatorServer -ORBInitialPort 1050 -ORBInitialHost localhost
```

You should see:

```
Calculator Server ready and waiting...
```

---

### üß™ Step 7: Run Client

In a new terminal:

```bash
java CalculatorClient -ORBInitialPort 1050 -ORBInitialHost localhost
```

Expected output:

```
Addition: 15.0
Subtraction: 5.0
Multiplication: 50.0
Division: 2.0
```

---

## üî¨ Theory Summary

### 1. IDL (Interface Definition Language)

* Language-independent way to define object interfaces.
* Translated into Java using `idlj`.

### 2. ORB (Object Request Broker)

* Middleware that handles communication between client and server.
* Client uses **stubs**, server uses **skeletons** generated from IDL.

### 3. Naming Service

* Acts like a **phonebook** to locate objects by name.
* `orbd` runs naming service on a known port (e.g., 1050).
* Used to bind (`rebind`) and resolve object references.

### 4. Servant Object

* Actual implementation of remote interface on the server side (`CalculatorImpl`).

---

## üìò Optional Concepts to Explore

| Concept                       | Explanation                                                                |
| ----------------------------- | -------------------------------------------------------------------------- |
| POA (Portable Object Adapter) | Manages object lifecycles and request dispatching.                         |
| Helper & Holder classes       | Auto-generated by `idlj`. Help in narrowing references and passing values. |
| CORBA vs RMI                  | CORBA is language-neutral, RMI is Java-only.                               |
| Java 11+                      | CORBA support removed. Use Java 8 or third-party libraries.                |

---
